<!DOCTYPE html>
<!--suppress ALL -->
<html>
<head>
    <meta charset="utf-8">
    <title>Ordina JWorks Tech Blog</title>
    <!-- Description, Keywords and Author -->
    <meta name="description" content="Ordina JWorks Tech blog
">
    <meta name="keywords" content="Ordina,ORAJ,JWorks,Blog,Java,Javascript,DevOps">
    <meta name="author" content="Ordina Belgium">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    
    <!-- Facebook Open Graph -->
    <meta property="og:url" content="http://ordina-jworks.github.io/spring/2016/02/06/Generating-Spring-REST-Docs-without-using-integration-tests.html" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Generating Spring REST Docs without using integration tests -  " />
    <meta property="og:description" content="Ordina JWorks Tech Blog" />
    <meta property="og:image" content="http://ordina-jworks.github.io/img/spring.png" />
    

    <!-- Styles -->
    <!-- Bootstrap CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font awesome CSS -->
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <!-- Magnific Popup -->
    <link href="/css/magnific-popup.css" rel="stylesheet">
    <!-- Owl carousel -->
    <link href="/css/owl.carousel.css" rel="stylesheet">

    <!-- CSS for this page -->

    <!-- Base style -->
    <link href="/css/styles/style.css" rel="stylesheet">
    <!-- Skin CSS -->
    <link href="/css/styles/skin-orange.css" rel="stylesheet" id="color_theme">

    <!-- Syntax highlighting -->
    <link href="/css/syntax.css" rel="stylesheet">

    <!-- Custom CSS. Type your CSS code in custom.css file -->
    <link href="/css/custom.css" rel="stylesheet">

    <!-- Favicon -->
    <link rel="shortcut icon" href="#">

    <script src="https://use.typekit.net/gzh0mbm.js"></script>
    <script>
        try {
            Typekit.load({async: true});
        } catch (e) {
        }
    </script>
</head>

<!-- Add class "boxed" along with body for boxed layout. -->
<!-- Add "pattern-x" (1 to 5) for background patterns. -->
<!-- Add "img-x" (1 to 5) for background images. -->
<body>

<!-- Outer Starts -->
<div class="outer">
    <!-- Header two Starts -->
    <div class="header-2">

        <!-- Container -->
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <div class="logo">
                        <h1><a href="/"><img src="/img/jworks/jworks-400x400.jpg"
                                                               width="100"
                                                               height="100"/> </a></h1>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="navy">
                        <ul>
                            <li><a href="/">Home</a></li>
                            <li><a href="/about/">About Us</a></li>
                            <li><a href="/contact">Contact Us</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Header two ends -->

    <!-- Main content starts -->

    <div class="main-block">

        <!-- Page heading two starts -->

        <div class="page-heading-two">
            <div class="container">
                <h2>JWorks Tech Blogs<span style="margin-left: 10px"> Powered by Ordina</span></h2>

                <div class="clearfix"></div>
            </div>
        </div>

        <!-- Page heading two ends -->

        <div class="container tk-acumin-pro">
            <div class="post">
    <div class="row">
        <div class="col-md-12">
            <h1>Generating Spring REST Docs without using integration tests</h1>
            <p id="post-meta">
                Posted Feb 6, 2016 in <a href="/categories/spring/">Spring</a>
                
                    by 
                    
                
                        
                        <a href="/author/tim-ysewyn/">Tim Ysewyn</a>
                    
                
                
                    <br />
                    <i class="fa fa-tags"></i>
                        
                            <a href="/tags/spring/">Spring</a>,
                        
                            <a href="/tags/rest-docs/">REST Docs</a>,
                        
                            <a href="/tags/spring-rest-docs/">Spring REST Docs</a>,
                        
                            <a href="/tags/testing/">Testing</a>,
                        
                            <a href="/tags/integration/">Integration</a>,
                        
                            <a href="/tags/integration-test/">Integration Test</a>,
                        
                            <a href="/tags/unit-test/">Unit Test</a>
                        
                
            </p>
        </div>
    </div>
    <br />
    <article class="post-content">
        <h2 id="the-problem">The problem</h2>

<p>A couple of days ago I was working on a project of one of our customers.
One of their new applications needed to expose a public API, and of course we needed to hand over a set of documentation about those REST endpoints.
Some people were already starting to do this manually in Confluence, but after a while (and we’re talking about a timespan just under 2 hours) this became a tedious job. 
We had to continuously adjust the input &amp; output contracts, the different endpoints,…
Using Spring REST Docs I wanted to automatically document all of the public API endpoints, while we were also testing all of the components in the whole application.
For some undisclosed reasons we simply couldn’t write integration tests, so we were stuck with our unit tests and mocked objects.</p>

<h2 id="the-solution">The solution</h2>

<p>Imagine you have following service and controller in a simple Spring Boot application:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java">    <span class="nd">@Service</span>
    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">DeviceService</span> <span class="o">{</span>

        <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Device</span><span class="o">&gt;</span> <span class="nf">getDevices</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Device</span><span class="o">&gt;</span> <span class="n">devices</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

            <span class="cm">/*
                Some business logic here...
            */</span>

            <span class="k">return</span> <span class="n">devices</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@RestController</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"devices"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">DeviceController</span> <span class="o">{</span>

        <span class="kd">private</span> <span class="n">DeviceService</span> <span class="n">deviceService</span><span class="o">;</span>

        <span class="nd">@Autowired</span>
        <span class="kd">public</span> <span class="nf">DeviceController</span><span class="o">(</span><span class="n">DeviceService</span> <span class="n">deviceService</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">deviceService</span> <span class="o">=</span> <span class="n">deviceService</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON_VALUE</span><span class="o">)</span>
        <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Device</span><span class="o">&gt;</span> <span class="nf">getDevices</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">deviceService</span><span class="o">.</span><span class="na">getDevices</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    </code></pre></figure>

<p><br />
Since this is a Spring Boot application both classes will automagically be instantiated.
Because you need to annotate your unit tests at class level with <strong>@WebAppConfiguration</strong> and <strong>@SpringApplicationConfiguration</strong>, we can easily create a new Spring Boot application and use this for our documentation.
In this new application we set the base package that needs to be scanned to our controller sub package, and create a mock implementation of our <code class="highlighter-rouge">DeviceService</code>.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java">    <span class="nd">@SpringBootApplication</span><span class="o">(</span><span class="n">scanBasePackages</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"be.ordina.blog.controller"</span> <span class="o">}</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>

        <span class="nd">@Bean</span>
        <span class="kd">public</span> <span class="n">DeviceService</span> <span class="nf">getDeviceService</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">EasyMock</span><span class="o">.</span><span class="na">createStrictMock</span><span class="o">(</span><span class="n">DeviceService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    </code></pre></figure>

<p><br />
Our <code class="highlighter-rouge">DeviceControllerTests</code> class will then look something like this:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java">    <span class="nd">@RunWith</span><span class="o">(</span><span class="n">SpringJUnit4ClassRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nd">@SpringApplicationConfiguration</span><span class="o">(</span><span class="n">classes</span> <span class="o">=</span> <span class="o">{</span> <span class="n">Application</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
    <span class="nd">@WebAppConfiguration</span>
    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">DeviceControllerTests</span> <span class="o">{</span>

        <span class="nd">@Rule</span>
        <span class="kd">public</span> <span class="n">RestDocumentation</span> <span class="n">restDocumentation</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RestDocumentation</span><span class="o">(</span><span class="s">"target/generated-snippets"</span><span class="o">);</span>

        <span class="nd">@Autowired</span>
        <span class="kd">private</span> <span class="n">WebApplicationContext</span> <span class="n">context</span><span class="o">;</span>

        <span class="nd">@Autowired</span>
        <span class="kd">public</span> <span class="n">DeviceService</span> <span class="n">deviceService</span><span class="o">;</span>

        <span class="kd">private</span> <span class="n">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>

        <span class="nd">@Before</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUp</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">mockMvc</span> <span class="o">=</span> <span class="n">MockMvcBuilders</span><span class="o">.</span><span class="na">webAppContextSetup</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">context</span><span class="o">)</span>
                                            <span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">documentationConfiguration</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">restDocumentation</span><span class="o">))</span>
                                            <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="nd">@After</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">cleanup</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">EasyMock</span><span class="o">.</span><span class="na">verify</span><span class="o">(</span><span class="n">deviceService</span><span class="o">);</span>
            <span class="n">EasyMock</span><span class="o">.</span><span class="na">reset</span><span class="o">(</span><span class="n">deviceService</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="nd">@Test</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getDevices</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
            <span class="n">Device</span> <span class="n">firstDevice</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Device</span><span class="o">(</span><span class="s">"iPhone 6"</span><span class="o">);</span>
            <span class="n">Device</span> <span class="n">secondDevice</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Device</span><span class="o">(</span><span class="s">"Nexus 5"</span><span class="o">);</span>
            
            <span class="n">List</span><span class="o">&lt;</span><span class="n">Device</span><span class="o">&gt;</span> <span class="n">devices</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
            <span class="n">devices</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">firstDevice</span><span class="o">);</span>
            <span class="n">devices</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">secondDevice</span><span class="o">);</span>

            <span class="n">EasyMock</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="n">deviceService</span><span class="o">.</span><span class="na">getDevices</span><span class="o">()).</span><span class="na">andReturn</span><span class="o">(</span><span class="n">devices</span><span class="o">);</span>

            <span class="n">EasyMock</span><span class="o">.</span><span class="na">replay</span><span class="o">(</span><span class="n">deviceService</span><span class="o">);</span>

            <span class="k">this</span><span class="o">.</span><span class="na">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/devices"</span><span class="o">).</span><span class="na">accept</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">))</span>
                        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
                        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$"</span><span class="o">,</span> <span class="n">hasSize</span><span class="o">(</span><span class="mi">2</span><span class="o">)))</span>
                        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$[0].name"</span><span class="o">,</span> <span class="n">is</span><span class="o">(</span><span class="n">firstDevice</span><span class="o">.</span><span class="na">getName</span><span class="o">())))</span>
                        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$[1].name"</span><span class="o">,</span> <span class="n">is</span><span class="o">(</span><span class="n">secondDevice</span><span class="o">.</span><span class="na">getName</span><span class="o">())))</span>
                        <span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="n">document</span><span class="o">(</span><span class="s">"device"</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
    </code></pre></figure>

<p><br />
So this is how I managed to get rid of the manual, tedious work and keep my unit tests - and got back to the more serious part of my life: coding like a monkey. =)
<br /></p>

<blockquote>
  <p>PS: All of the code above is checked in at our public github repo, so you are free to clone the working application! You can find it <a href="https://github.com/ordina-jworks/spring-rest-docs-without-integration-tests">here</a>!</p>
</blockquote>

    </article>
    <hr />
    
                
        
        
            <blockquote>
                <p>Tim is a Senior Principal Consultant at Ordina, where he helps fellow developers discovering top-notch technologies and methodologies as a Competence Leader for Microservices. He also enjoys the different challenges while developing iOS applications with Objective-C and Swift.<br />When not working for Ordina, you can find him working on various parts of the <a href="http://www.spring.io">Spring</a> framework.</p>

            </blockquote>
        
    
    
        <br /><br />
        <div id="disqus_thread"></div>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    
</div>

        </div>
    </div>
    <!-- Main content ends -->
</div>
<!-- Footer Starts -->
<footer class="footer">
    <!-- Container -->
    <div class="container">
        <!-- Foot Starts -->
        <div class="foot">
            <!-- Container -->
            <div class="container">
                <div class="row">
                    <div class="col-md-4 col-sm-6">
                        <!-- Foot Item -->
                        <div class="foot-item">
                            <!-- Heading -->
                            <h5 class="bold"><i class="fa fa-user"></i>&nbsp;&nbsp;Disclaimer</h5>

                            <p>Opinions expressed on this blog reflect the writer’s views and not the position of
                                Ordina.</p>

                            <div class="brand-bg">
                                <a href="/feed.xml" class="rss"><i
                                        class="fa fa-rss circle-3"></i></a>
                                <a target="_blank" href="https://www.facebook.com/lifeatordinabe" class="facebook"><i
                                        class="fa fa-facebook circle-3"></i></a>
                                <a target="_blank" href="https://twitter.com/lifeatordinabe"
                                   class="twitter"><i
                                        class="fa fa-twitter circle-3"></i></a>
                                <a target="_blank" href="https://www.linkedin.com/company/ordina-belgium"
                                   class="linkedin"><i
                                        class="fa fa-linkedin circle-3"></i></a>
                                <a target="_blank" href="https://www.linkedin.com/company/ordina-belgium" class="linkedin">
                                    <i class="fa fa-linkedin circle-3"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <!-- Foot Item -->
                        <div class="foot-item">
                            <!-- Heading -->
                            <h5 class="bold"><i class="fa fa-comments"></i>&nbsp;&nbsp;Recent Posts</h5>
                            <!-- Foot Item Content -->
                            <div class="foot-item-content">
                                <ul class="list-unstyled">
                                    
                                    <li>
                                        <span>12 Dec 2016</span> &raquo;
                                        <a href="/reactive/2016/12/12/Reactive-Programming-Spring-Reactor.html">
                                            Reactive Programming with Spring Reactor</a>
                                    </li>
                                    
                                    <li>
                                        <span>18 Nov 2016</span> &raquo;
                                        <a href="/jax%20london/2016/11/18/JAX-London-2016.html">
                                            JAX London 2016</a>
                                    </li>
                                    
                                    <li>
                                        <span>12 Nov 2016</span> &raquo;
                                        <a href="/cloud/2016/11/12/TheServerlessCloud.html">
                                            The Serverless Cloud</a>
                                    </li>
                                    
                                    <li>
                                        <span>31 Oct 2016</span> &raquo;
                                        <a href="/kickstarters/2016/10/31/Kickstarters-Project.html">
                                            Kickstarter project 2016</a>
                                    </li>
                                    
                                    <li>
                                        <span>10 Oct 2016</span> &raquo;
                                        <a href="/conferences/2016/10/10/Percona-Live-Amsterdam-2016.html">
                                            Percona Live Amsterdam 2016</a>
                                    </li>
                                    
                                    <li>
                                        <span>27 Sep 2016</span> &raquo;
                                        <a href="/conferences/2016/09/27/JOIN-2016.html">
                                            JOIN 2016</a>
                                    </li>
                                    
                                    <li>
                                        <span>23 Sep 2016</span> &raquo;
                                        <a href="/monitoring/2016/09/23/Monitoring-with-Prometheus.html">
                                            Monitoring with Prometheus</a>
                                    </li>
                                    
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <!-- Foot Item -->
                        <div class="foot-item">
                            <!-- Heading -->
                            <h5 class="bold"><i class="fa fa-building-o"></i>&nbsp;&nbsp;Contact Us</h5>
                            <!-- Foot Item Content -->
                            <div class="foot-item-content address">
                                <!-- Heading -->
                                <h6 class="bold"><i class="fa fa-home"></i>&nbsp;&nbsp;Ordina Belgium</h6>
                                <!-- Paragraph -->
                                <p class="add">
                                    Blarenberglaan 3B,<br/>
                                    Mechelen 2800, Belgium.</p>

                                <p class="tel"><i class="fa fa-phone"></i> Tel : + (32) - 15 29 58 58<br/>
                                    <i class="fa fa-envelope"></i> Mail : <a href="#">info@ordina.be</a><br/>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Foot Ends -->
        <!-- Footer Content -->
        <p class="pull-left">Copyright &copy; 2016 - <a href="#">Ordina JWorks</a></p>
        <ul class="list-inline pull-right">
            <!-- List -->
            <li><a href="/">Home</a>
            <li><a href="/about/">About</a></li>
            <li><a href="/contact/">Contact</a></li>
        </ul>
        <!-- Clearfix -->
        <div class="clearfix"></div>
    </div>
</footer>
<!-- Footer Ends -->

<!-- Outer Ends -->

<!-- Scroll to top -->
<span class="totop"><a href="#"><i class="fa fa-angle-up bg-color"></i></a></span>

<script src="/js/jquery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/placeholders.js"></script>
<script src="/js/jquery.magnific-popup.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/respond.min.js"></script>
<script src="/js/html5shiv.js"></script>
<script src="/js/main.js"></script>

<script src="/js/imagesloaded.min.js"></script>
<script src="/js/masonry.js"></script>

<!-- Javascript for this page -->
<script>
    // Initialize Masonry
    var $box = $('.blog-masonry').masonry();
    // Layout Masonry again after all images have loaded
    $box.imagesLoaded(function () {
        $box.masonry();
    });
</script>

<!-- Custom JS. Type your JS code in custom.js file -->
<script src="/js/custom.js"></script>

<!-- Disqus -->

    <script type="text/javascript">
        var disqus_config = function () {
            this.page.url = "https://ordina-jworks.github.io/spring/2016/02/06/Generating-Spring-REST-Docs-without-using-integration-tests.html";
            this.page.identifier = "/spring/2016/02/06/Generating-Spring-REST-Docs-without-using-integration-tests.html";
            this.page.title = "Generating Spring REST Docs without using integration tests";
        };
    </script>
    <script src="//ordina-jworks.disqus.com/embed.js" async></script>


<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date();
        a = s.createElement(o);
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-70040502-1', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>
