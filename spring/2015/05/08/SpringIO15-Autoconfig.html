<!DOCTYPE html>
<!--suppress ALL -->
<html>
<head>
    <meta charset="utf-8">
    <title>Ordina JWorks Tech Blog</title>
    <!-- Description, Keywords and Author -->
    <meta name="description" content="Ordina JWorks Tech blog
">
    <meta name="keywords" content="Ordina,ORAJ,JWorks,Blog,Java,Javascript,DevOps">
    <meta name="author" content="Ordina Belgium">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    
    <!-- Facebook Open Graph -->
    <meta property="og:url" content="http://ordina-jworks.github.io/spring/2015/05/08/SpringIO15-Autoconfig.html" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Master Spring Boot auto-configuration -  " />
    <meta property="og:description" content="Ordina JWorks Tech Blog" />
    <meta property="og:image" content="http://ordina-jworks.github.io/img/springio.jpg" />
    

    <!-- Styles -->
    <!-- Bootstrap CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font awesome CSS -->
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <!-- Magnific Popup -->
    <link href="/css/magnific-popup.css" rel="stylesheet">
    <!-- Owl carousel -->
    <link href="/css/owl.carousel.css" rel="stylesheet">

    <!-- CSS for this page -->

    <!-- Base style -->
    <link href="/css/styles/style.css" rel="stylesheet">
    <!-- Skin CSS -->
    <link href="/css/styles/skin-orange.css" rel="stylesheet" id="color_theme">

    <!-- Syntax highlighting -->
    <link href="/css/syntax.css" rel="stylesheet">

    <!-- Custom CSS. Type your CSS code in custom.css file -->
    <link href="/css/custom.css" rel="stylesheet">

    <!-- Favicon -->
    <link rel="shortcut icon" href="#">

    <script src="https://use.typekit.net/gzh0mbm.js"></script>
    <script>
        try {
            Typekit.load({async: true});
        } catch (e) {
        }
    </script>
</head>

<!-- Add class "boxed" along with body for boxed layout. -->
<!-- Add "pattern-x" (1 to 5) for background patterns. -->
<!-- Add "img-x" (1 to 5) for background images. -->
<body>

<!-- Outer Starts -->
<div class="outer">
    <!-- Header two Starts -->
    <div class="header-2">

        <!-- Container -->
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <div class="logo">
                        <h1><a href="/"><img src="/img/jworks/jworks-400x400.jpg"
                                                               width="100"
                                                               height="100"/> </a></h1>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="navy">
                        <ul>
                            <li><a href="/">Home</a></li>
                            <li><a href="/about/">About Us</a></li>
                            <li><a href="/contact">Contact Us</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Header two ends -->

    <!-- Main content starts -->

    <div class="main-block">

        <!-- Page heading two starts -->

        <div class="page-heading-two">
            <div class="container">
                <h2>JWorks Tech Blogs<span style="margin-left: 10px"> Powered by Ordina</span></h2>

                <div class="clearfix"></div>
            </div>
        </div>

        <!-- Page heading two ends -->

        <div class="container tk-acumin-pro">
            <div class="post">
    <div class="row">
        <div class="col-md-12">
            <h1>Master Spring Boot auto-configuration</h1>
            <p id="post-meta">
                Posted May 8, 2015 in <a href="/categories/spring/">Spring</a>
                
                    by 
                    
                
                        
                        <a href="/author/andreas-evers/">Andreas Evers</a>
                    
                
                
                    <br />
                    <i class="fa fa-tags"></i>
                        
                            <a href="/tags/spring/">Spring</a>
                        
                
            </p>
        </div>
    </div>
    <br />
    <article class="post-content">
        <blockquote>
  <p>Spring boot allows you to extend its convention-over-configuration approach by creating your own autoconfigurations. There are some important details you shouldn’t forget.</p>
</blockquote>

<h3 id="master-spring-boot-auto-configuration">Master Spring Boot auto-configuration</h3>

<p><em>Speaker: Stéphane Nicoll - <a href="http://www.springio.net/master-spring-boot-auto-configuration/">Talk &amp; speaker description</a></em></p>

<p><img class="p-image float-image" alt="Stéphane Nicoll" src="https://www.ordina.be/~/media/images/ordinabe/blogs/andreas10.png" />In order to create your own autoconfiguration, it’s important to remember the <strong>spring.factories</strong> file in the META-INF folder of the autoconfiguration project.</p>

<p>The autoconfiguration class itself should have @Configuration (of course) and utilise conditional annotations as much as possible. Especially on the bean initializations the rule of thumb is the more <strong>conditionals</strong> the better. This enables users of your autoconfiguration to override specific elements of the autoconfiguration class. Aside from fully overriding beans, you can also expose properties under your own namespace. Together both these concepts allow small configuration-based modifications and bigger bean-overriding modifications by the user.</p>

<p>Spring offers many types of Conditional annotations. The regular ConditionalOnClass or ConditionalOnMissingClass and ConditionalOnBean or ConditionalOnMissingBean are the most common, but also ConditionalOnProperty, OnResource, OnExpression and others are possible. You can even have nested conditions and for the most specific needs you can always write your own conditional annotation with whatever logic you require.</p>

<p>By looking how Spring’s autoconfiguration classes are built, it’s easy to figure out how to do it yourself. Especially the ConfigurationProperties are pretty straight forward once you see an example. Don’t forget to put the @EnableConfigurationProperties annotation on your autoconfiguration class however.
To expose your <strong>configurationproperties</strong> to IntelliJ, the trick is in the maven dependencies. You should add the “spring-boot-configuration-processor” dependency. This will generate metadata regarding the properties of your autoconfiguration which IntelliJ uses. Once that’s done, IntelliJ will also autocomplete your properties in the property files.
Support for yml configuration autocompletion in IntelliJ is coming by the way.</p>

<p>Once your autoconfiguration class is created, it’s a good idea to <strong>bundle</strong> it into a maven module that can be used as a dependency by other projects. It’s important to use the recommended naming convention for your modules - especially if you’re building autoconfiguration for the community - or it might clash with the modules from spring boot itself. The recommended naming is xyz-spring-boot-autoconfigure and xyz-spring-boot-starter. The former module should contain the autoconfiguration class (and don’t forget the spring.factories file), and the latter should contain the recommended dependencies to enable the autoconfiguration. That way the user can independently have the autoconfiguration and the classes that enable it. The starter is entirely optional though.
The spring.factories file should contain your configuration like this: a key being org.springframework.boot.autoconfigure.EnableAutoConfiguration with value the qualified name of your autoconfiguration class.</p>

<p>To further allow the user to customize your autoconfiguration, you can expose a <strong>customize</strong> hook into your autoconfiguration. This should accept an xyzConfigCustomizer interface (you can create whatever interface you want basically) with a single customize method. This customize hook is executed after the autoconfiguration is executed, but before actual instantiation of the beans. The user then just has to create a bean that implements the customizer interface. <a href="https://github.com/snicoll-demos/spring-boot-master-auto-configuration/blob/master/hornetq-spring-boot-autoconfigure/src/main/java/hornetq/autoconfigure/HornetQAutoConfiguration.java">An example is available on GitHub.</a></p>

<p>One final concern of autoconfiguration is the <strong>order</strong> in which they are executed. This applies to conditions inside the autoconfiguration but also to combined autoconfigurations. Always make sure the cheapest condition comes first. So expensive SpEL expression conditions should come after conditionalOnBeans. Between autoconfigurations you can use either the annotation @AutoConfigureBefore and After on the autoconfiguration class, or the @Order annotation. When no order or before or after condition is specified, there is no guarantee when the autoconfiguration will be executed.
Conditions are being executed in two phases: PARSE_CONFIGURATION phase and REGISTER_BEAN phase. PARSE_CONFIGURATION evaluates the condition when the @Configuration-annotated class is parsed. This gives a chance to fully exclude the configuration class. REGISTER_BEAN evaluates the condition when a bean from a configuration class is registered. This does not prevent the configuration class to be added but it allows to skip a bean definition if the condition does not match (as defined by the matches method of the Condition interface).</p>

<p>The slidedeck of this talk can be found here: <a href="https://speakerdeck.com/snicoll/master-spring-boot-auto-configuration">https://speakerdeck.com/snicoll/master-spring-boot-auto-configuration</a></p>

    </article>
    <hr />
    
                
        
        
            <blockquote>
                <p>Andreas is a principal Java consultant at Ordina, passionate about the Spring ecosystem, microservices, REST, clean code and best practices in general. An avid open source enthusiast and Spring contributor. Helps fellow developers as Competence Center leader for architecture and best practices by giving workshops, talks and courses about the newest technologies.</p>

            </blockquote>
        
    
    
        <br /><br />
        <div id="disqus_thread"></div>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    
</div>

        </div>
    </div>
    <!-- Main content ends -->
</div>
<!-- Footer Starts -->
<footer class="footer">
    <!-- Container -->
    <div class="container">
        <!-- Foot Starts -->
        <div class="foot">
            <!-- Container -->
            <div class="container">
                <div class="row">
                    <div class="col-md-4 col-sm-6">
                        <!-- Foot Item -->
                        <div class="foot-item">
                            <!-- Heading -->
                            <h5 class="bold"><i class="fa fa-user"></i>&nbsp;&nbsp;Disclaimer</h5>

                            <p>Opinions expressed on this blog reflect the writer’s views and not the position of
                                Ordina.</p>

                            <div class="brand-bg">
                                <a target="_blank" href="https://www.facebook.com/lifeatordinabe" class="facebook"><i
                                        class="fa fa-facebook circle-3"></i></a>
                                <a target="_blank" href="https://twitter.com/lifeatordinabe"
                                   class="twitter"><i
                                        class="fa fa-twitter circle-3"></i></a>
                                <a target="_blank" href="https://www.linkedin.com/company/ordina-belgium"
                                   class="linkedin"><i
                                        class="fa fa-linkedin circle-3"></i></a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <!-- Foot Item -->
                        <div class="foot-item">
                            <!-- Heading -->
                            <h5 class="bold"><i class="fa fa-comments"></i>&nbsp;&nbsp;Recent Posts</h5>
                            <!-- Foot Item Content -->
                            <div class="foot-item-content">
                                <ul class="list-unstyled">
                                    
                                    <li>
                                        <span>13 May 2016</span> &raquo;
                                        <a href="/conference/2016/05/13/JS-Conf-Budapest-day-2.html">
                                            JS Conf Budapest Day 2</a>
                                    </li>
                                    
                                    <li>
                                        <span>12 May 2016</span> &raquo;
                                        <a href="/conference/2016/05/12/JS-Conf-Budapest-day-1.html">
                                            JS Conf Budapest Day 1</a>
                                    </li>
                                    
                                    <li>
                                        <span>01 May 2016</span> &raquo;
                                        <a href="/microservices/2016/05/01/Using-JWT-Tokens-for-State-Transfer.html">
                                            Using JWT for state transfer</a>
                                    </li>
                                    
                                    <li>
                                        <span>25 Apr 2016</span> &raquo;
                                        <a href="/angularjs-typescript/2016/04/25/component-based-application-architecture-with-angularjs-and-typescript.html">
                                            Component-based application architecture with AngularJS and Typescript</a>
                                    </li>
                                    
                                    <li>
                                        <span>22 Apr 2016</span> &raquo;
                                        <a href="/microservices/2016/04/22/Lagom-First-Impressions-and-Initial-Comparison-to-Spring-Cloud.html">
                                            Lagom: First Impressions and Initial Comparison to Spring Cloud</a>
                                    </li>
                                    
                                    <li>
                                        <span>09 Apr 2016</span> &raquo;
                                        <a href="/microservices/2016/04/09/Ordina-becomes-Netflix-OSS-contributor.html">
                                            Ordina becomes Netflix OSS contributor</a>
                                    </li>
                                    
                                    <li>
                                        <span>07 Apr 2016</span> &raquo;
                                        <a href="/ionic/2016/04/07/Ionic-Protractor.html">
                                            Protractor testing in Ionic app</a>
                                    </li>
                                    
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <!-- Foot Item -->
                        <div class="foot-item">
                            <!-- Heading -->
                            <h5 class="bold"><i class="fa fa-building-o"></i>&nbsp;&nbsp;Contact Us</h5>
                            <!-- Foot Item Content -->
                            <div class="foot-item-content address">
                                <!-- Heading -->
                                <h6 class="bold"><i class="fa fa-home"></i>&nbsp;&nbsp;Ordina Belgium</h6>
                                <!-- Paragraph -->
                                <p class="add">
                                    Blarenberglaan 3B,<br/>
                                    Mechelen 2800, Belgium.</p>

                                <p class="tel"><i class="fa fa-phone"></i> Tel : + (32) - 15 29 58 58<br/>
                                    <i class="fa fa-envelope"></i> Mail : <a href="#">info@ordina.be</a><br/>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Foot Ends -->
        <!-- Footer Content -->
        <p class="pull-left">Copyright &copy; 2016 - <a href="#">Ordina JWorks</a></p>
        <ul class="list-inline pull-right">
            <!-- List -->
            <li><a href="/">Home</a>
            <li><a href="/about/">About</a></li>
            <li><a href="/contact/">Contact</a></li>
        </ul>
        <!-- Clearfix -->
        <div class="clearfix"></div>
    </div>
</footer>
<!-- Footer Ends -->

<!-- Outer Ends -->

<!-- Scroll to top -->
<span class="totop"><a href="#"><i class="fa fa-angle-up bg-color"></i></a></span>

<script src="/js/jquery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/placeholders.js"></script>
<script src="/js/jquery.magnific-popup.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/respond.min.js"></script>
<script src="/js/html5shiv.js"></script>
<script src="/js/main.js"></script>

<script src="/js/imagesloaded.min.js"></script>
<script src="/js/masonry.js"></script>

<!-- Javascript for this page -->
<script>
    // Initialize Masonry
    var $box = $('.blog-masonry').masonry();
    // Layout Masonry again after all images have loaded
    $box.imagesLoaded(function () {
        $box.masonry();
    });
</script>

<!-- Custom JS. Type your JS code in custom.js file -->
<script src="/js/custom.js"></script>

<!-- Disqus -->

    <script type="text/javascript">
        var disqus_config = function () {
            this.page.url = "https://ordina-jworks.github.io/spring/2015/05/08/SpringIO15-Autoconfig.html";
            this.page.identifier = "/spring/2015/05/08/SpringIO15-Autoconfig.html";
            this.page.title = "Master Spring Boot auto-configuration";
        };
    </script>
    <script src="//ordina-jworks.disqus.com/embed.js" async></script>


<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date();
        a = s.createElement(o);
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-70040502-1', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>
